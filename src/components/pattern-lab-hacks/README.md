@todo: refactor and break this apart